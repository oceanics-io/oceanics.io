[build]
  base ="/"
  command = "make build"
  publish = "public"
  functions = "/functions"

[build.environment]
  GO_VERSION = "1.14.6"

[[redirects]]
  from = "/catalog"
  to = "/app"
  force = true

[[redirects]]
  from = "/vessel"
  to = "/app"
  force = true

[[redirects]]
  from = "/map"
  to = "/app"
  force = true

[[redirects]]
  from = "/oceanside"
  to = "/app"
  force = true

[[redirects]]
  from = "/turbulence-demo"
  to = "/app"
  force = true

[[redirects]]
  from = "/legal"
  to = "/policy"
  force = true


[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[redirects]]
  from = "/api/mesh-nodes/*"
  to = "oceanicsdotio.cdn.nyc3.digitaloceanspaces.com"
  status = 303

[[plugins]]
  package = "netlify-plugin-gatsby-cache"

[[redirects]]
  from = "/bathysphere"
  to = "/bathysphere.html"
  status = 301
  force = false

[[redirects]]
  from = "/api/*"
  to = "https://bathysphere-f6ccuy4zzq-uc.a.run.app/api/:splat"
  status = 200
  force = true
  headers = {X-From = "Netlify"}


[[headers]]
  for = "/*"
  [headers.values]
    Access-Control-Allow-Origin = "*"
 
    Content-Security-Policy = '''
    graph.oceanics.io,
    faas.oceanics.io,
    cdn.jsdelivr.net,
    *.googleapis.com,
    *.github.com
    '''
