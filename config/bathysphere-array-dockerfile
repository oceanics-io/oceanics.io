FROM continuumio/miniconda3:4.6.14

COPY config/environment.yml ./
RUN conda env create -f environment.yml && \
    echo "source activate bathysphere" > ~/.bashrc

WORKDIR bathysphere
COPY bathysphere_array ./bathysphere
COPY src ./src

RUN mkdir data && mkdir images
RUN chmod +x ./src/start.sh
ENTRYPOINT ["./src/start.sh"]