FROM continuumio/miniconda3:4.6.14

COPY config/bathysphere-array-env.yml ./
RUN conda env create -f bathysphere-array-env.yml && \
    echo "source activate bathysphere-array" > ~/.bashrc

WORKDIR bathysphere
COPY bathysphere_array ./bathysphere_array
COPY src ./src

RUN mkdir data && mkdir images
RUN chmod +x ./src/start.sh
ENTRYPOINT ["./src/start.sh"]